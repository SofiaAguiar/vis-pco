---
title: "Visualização de PCO"
author: "EstatMG - Sofia Aguiar"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

dados <- read_csv("base de dados.csv")

dados[is.na(dados)] <- 0

dados$score <- apply(dados[3:88], 1, mean)

dados <- dados %>% 
  mutate(rank = min_rank(dados$score))
```
  
    
Esse é um documento interativo, criado para visualizar melhor os resultados da pesquisa de PCO - Pesquisa de Clima Organizacional.   
Aqui podemos visualizar o resultado final do score dos dez funcionários entrevistados, além dos resultados individuais de cada questionamento.

### Score final

You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change.  This demonstrates how a standard R plot 'can be made interactive by wrapping it in the Shiny `renderPlot` function. The `selectInput` and `sliderInput` functions create the input widgets used to drive the plot.


```{r, echo=FALSE, warning=FALSE}

ggplot(dados, aes(x = dados$score, fill = as.factor(dados$rank))) +
  geom_bar(width = 0.15) +
  theme_gray() +
  scale_fill_brewer(palette = 'Greens') +
  scale_x_continuous('Score final', limits = c(1, 5)) +
  theme(legend.position="none")

```


```{r eruptions, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```

## Embedded Application

It's also possible to embed an entire Shiny application within an R Markdown document using the `shinyAppDir` function. This example embeds a Shiny application located in another directory:

```{r tabsets, echo=FALSE}
shinyAppDir(
  system.file("examples/06_tabsets", package = "shiny"),
  options = list(
    width = "100%", height = 550
  )
)
```

Note the use of the `height` parameter to determine how much vertical space the embedded application should occupy.

You can also use the `shinyApp` function to define an application inline rather then in an external directory.

In all of R code chunks above the `echo = FALSE` attribute is used. This is to prevent the R code within the chunk from rendering in the document alongside the Shiny components.



